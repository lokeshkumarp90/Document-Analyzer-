<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Demo</title>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: auto; }
        input, button { margin-bottom: 10px; }
        #output { padding: 15px; border: 1px solid #ccc; min-height: 200px; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>Document Analyser using Gemini API</h1>
    <p>
        <!-- <strong>WARNING:</strong> This code exposes your API key. Do not use this in a production environment. -->
    </p>

    <input type="file" id="document-upload" accept=".pdf">
	 <input type="text" id="user-query" placeholder="e.g., 'Extract the author and publication date'">
    <button id="get-summary-btn">Get Result</button>

    <h3>Generated Result:</h3>
    <div id="output">The result will appear here.</div>

    <script type="module">
	import { GoogleGenerativeAI } from 'https://esm.sh/@google/generative-ai';
debugger;
// ⚠️ DANGER: DO NOT DO THIS IN PRODUCTION. This exposes your API key to everyone.
const API_KEY = "AIzaSyAhPSQNh5TyKhChQNSHgfUOeOjkEYlyCkk"; 

async function fileToGenerativePart(file) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => {
            const base64Data = reader.result.split(',')[1];
            resolve({
                inlineData: {
                    data: base64Data,
                    mimeType: file.type,
                },
            });
        };
        reader.onerror = reject;
        reader.readAsDataURL(file);
    });
}

document.getElementById('get-summary-btn').addEventListener('click', async () => {
	debugger
    const fileInput = document.getElementById('document-upload');
    const outputDiv = document.getElementById('output');
    const file = fileInput.files[0];

    if (!file) {
        outputDiv.innerText = "Please select a document.";
        return;
    }

    try {
        outputDiv.innerText = "Generating summary...";

        const genAI = new GoogleGenerativeAI(API_KEY);
        const model = genAI.getGenerativeModel({ model: "gemini-2.5-flash" });

        const prompt = document.getElementById('user-query').value;//"how to use the idlist attribute";
        const documentPart = await fileToGenerativePart(file);

        const result = await model.generateContent([prompt, documentPart]);
        const response = await result.response;
        const text = response.text();

        outputDiv.innerText = text;

    } catch (error) {
        console.error(error);
        outputDiv.innerText = "An error occurred: " + error.message;
    }
});
	</script>
</body>
</html>